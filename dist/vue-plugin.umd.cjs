(function(m,f){typeof exports=="object"&&typeof module<"u"?f(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],f):(m=typeof globalThis<"u"?globalThis:m||self,f(m.VuePlugin={},m.Vue))})(this,function(m,f){var K,G,$,R,X,Y,Z,Q,tt,nt,bt,et,U,st,J,z;"use strict";var ut=(m,f,C)=>{if(!f.has(m))throw TypeError("Cannot "+C)};var g=(m,f,C)=>(ut(m,f,"read from private field"),C?C.call(m):f.get(m)),_=(m,f,C)=>{if(f.has(m))throw TypeError("Cannot add the same private member more than once");f instanceof WeakSet?f.add(m):f.set(m,C)},L=(m,f,C,W)=>(ut(m,f,"write to private field"),W?W.call(m,C):f.set(m,C),C);var wt=(m,f,C)=>(ut(m,f,"access private method"),C);const C="&lt;",W="&gt;",ot="/";class Tt{constructor(t,e=!1){_(this,nt);_(this,K,[]);_(this,G,"");_(this,$,"");_(this,R,[]);_(this,X,[]);_(this,Y,[]);_(this,Z,[]);_(this,Q,[]);_(this,tt,[]);L(this,G,t.trim()),L(this,$,`${g(this,G)}
<Eof />`),this.protect(),e&&this.markupQuotes(),this.collectWords(g(this,$)),this.makeMistakes()}get list(){return g(this,K)}get text(){return g(this,G)}get workingText(){return g(this,$)}get words(){return g(this,R)}get mistakes(){return g(this,Q)}get mistakeCursors(){return g(this,tt)}get phraseStarts(){return g(this,X)}get phraseLengths(){return g(this,Y)}get wordEnds(){return g(this,Z)}translateBracket(t,e,i=!1){let n=t,s=!1;return"CDETQRG".includes(e)&&(e==="C"&&(n=i?")":"(",s=!0),e==="D"&&(n=i?"}}":"{{",s=!0),e==="E"&&(n=i?"}":"{",s=!0),e==="T"&&(n=i?"]":"[",s=!0),e==="Q"&&(n="'",s=!0),e==="R"&&(n='"',s=!0),e==="G"&&(n="`",s=!0)),{word:n,translated:s}}markupQuotes(){let t=g(this,$);const e=/(["'`])((\s|((\\)*)\\.|.)*?)\1/gm;let i;const n=[];for(;(i=e.exec(t))!==null;)i.index===e.lastIndex&&e.lastIndex++,n.push(i);for(let s=n.length-1;s>-1;s--){const o=n[s],r=o[1],d=o[0];let l=o[2];const h=o.index+1,u=h+d.length-1;let x="";r==='"'?x="R":r==="'"?x="Q":r==="`"&&(x="G"),l=l.replace(/&lt;/g,"&pp;"),l=l.replace(/&gt;/g,"&pg;");const y=`&oq;${x}&cq;${l}&oq;/${x}&cq;`,I=t.substring(0,h-1),w=t.substring(u);t=I+y+w}L(this,$,t)}doAttributes(t){const e={},i=/([\w]*)(\[\])?=("([\S ][^"]*)"|'([\S]*)'|\{\{ ([\w]*) \}\}|\{([\S ]*)\})/gm;let n;const s=[];for(;(n=i.exec(t))!==null;)n.index===i.lastIndex&&i.lastIndex++,s.push(n);for(let o=0;o<s.length;o++){const r=s[o],d=r[1],l=r[2],h=r[3].substring(0,1),u=r[4];l==="[]"?(e[d]===void 0&&(e[d]=[]),e[d].push(h+u)):e[d]=`${h}${u}`}return e}isClosedTag(t){let e=!1;const{text:i}=t;return i===""||(e=i.substring(i.length-5,i.length)===ot+W),e}isCloserTag(t){let e=!1;const{text:i}=t;return i===""||(e=i.substring(0,5)===C+ot),e}makeTag(t,e,i,n,s=!1){const{text:o}=t,{name:r}=t,d=this.list.length,l={};return l.id=t.id,l.name=r===""?"Fragment":r,l.text=o,l.startsAt=t.startsAt,l.endsAt=t.endsAt,s||(l.uid=wt(this,nt,bt),l.method="echo",l.props=l.name==="Fragment"?[]:[],l.depth=i,l.hasCloser=n,l.node=!1,l.isSingle=!1),(e[i]===void 0||e[i]===null)&&(e[i]=d-1),l.parentId=e[i],l}protect(){let t=g(this,$);t=t.trim(),t=t.replace(/\{\{/g,"<D>"),t=t.replace(/\}\}/g,"</D>"),t=t.replace(/\(/g,"<C>"),t=t.replace(/\)/g,"</C>"),t=t.replace(/\{/g,"<E>"),t=t.replace(/\}/g,"</E>"),t=t.replace(/\[/g,"<T>"),t=t.replace(/\]/g,"</T>"),t=t.replace(/<([/\w])/g,`${C}$1`),t=t.replace(/>/g,W),L(this,$,t)}collectTags(t,e="[\\w]+"){const i=[],n=[],s=`${C}\\/?(${e})((\\s|.*?)*?)\\/?${W}`,o=new RegExp(s,"gm");let r;for(;(r=o.exec(t))!==null;)r.index===o.lastIndex&&o.lastIndex++,n.push(r);let d=0;return n.forEach(l=>{const h=l;h.id=d,h.text=l[0],h.name=l[1]===null?"Fragment":l[1],h.startsAt=l.index,h.endsAt=l.index+h.text.length-1,delete h[0],delete h[1],delete h[2],delete h[3],i.push(h),d++}),i}collectWords(t){const e=[],i=[];let n=/([&oqpg;]{4})[\w /]+([&cqpp;]{4})/gm,s;for(;(s=n.exec(t))!==null;)s.index===n.lastIndex&&n.lastIndex++,i.push(s);let o=t;for(let r=i.length-1;r>-1;r--){const d=i[r][0],l=i[r].index+1,h=l+d.length-1,u="•".repeat(d.length),x=o.substring(0,l-1),y=o.substring(h);o=x+u+y}for(n=/([&lt;]{4})[\w /]+([&gt;]{4})/gm;(s=n.exec(o))!==null;)s.index===n.lastIndex&&n.lastIndex++,i.push(s);for(let r=i.length-1;r>-1;r--){const d=i[r][0],l=i[r].index+1,h=l+d.length-1,u="•".repeat(d.length),x=o.substring(0,l-1),y=o.substring(h);o=x+u+y}for(n=/([&ltgt;]{4})/gm;(s=n.exec(o))!==null;)s.index===n.lastIndex&&n.lastIndex++,i.push(s);for(let r=i.length-1;r>-1;r--){const d=i[r][0],l=i[r].index+1,h=l+d.length-1,u="•".repeat(d.length),x=o.substring(0,l-1),y=o.substring(h);o=x+u+y}for(n=/((?!•)\S[^•\n]*)/g;(s=n.exec(o))!==null;)s.index===n.lastIndex&&n.lastIndex++,g(this,X).push(s.index),g(this,Y).push(s[0].length);for(n=/((?!•)\S[^•\n ]*)/g;(s=n.exec(o))!==null;){s.index===n.lastIndex&&n.lastIndex++;const r={};r.text=s[0],r.startsAt=s.index,r.endsAt=r.startsAt+s[0].length-1,e.push(r),g(this,Z).push(r.endsAt)}L(this,R,e)}makeMistakes(){let t=Math.ceil(Math.random()*2)-2;const e=Math.ceil(Math.random()*3)+2;g(this,R).forEach(i=>{if(t++,t%e!==0||i.text.length<4)return;const n=Math.ceil(Math.random()*i.text.length)-1,s=String.fromCharCode(Math.ceil(Math.random()*26)+96);g(this,tt).push(i.startsAt+n),g(this,Q).push(s)})}makeFaultyText(){let t=g(this,$);g(this,Q).forEach(e=>{const i=t.substring(0,e.startsAt),n=t.substring(e.endsAt+1);t=i+e.text+n}),L(this,$,t)}splitTags(t){let e=[...t],i=e.length,n=0,s=!1,o=0;const r=i;let d=!1;const l=[],h=[];for(;e.length>0&&!s&&!d;){if(n===i){if(n=0,e=Object.values(e),i=e.length,i===0){s=!0;continue}o++,d=o>r+1}const u=e[n];if(e.length===1&&u.name==="Eof"){s=!0;continue}if(this.isClosedTag(u)&&u.name!=="Eof"){h[n]=e[n],delete e[n],n++;continue}if(n+1<i){const x=e[n+1];if(!this.isCloserTag(u)&&this.isCloserTag(x)){if(u.name!==x.name){l.push(u),delete e[n],n++;continue}h[n]=e[n],h[n+1]=e[n+1],delete e[n],delete e[n+1],n+=2;continue}}n++}return{regularTags:h,singleTags:l}}replaceTags(t,e){let i=t,n=e;const s=[];e.forEach(o=>{s[o.id]=o}),s.sort(),n=Object.values(s);for(let o=n.length-1;o>-1;o--){const r=n[o];r.text=r.text.substring(0,r.text.length-4)+ot+W;const d=i.substring(0,r.startsAt),l=i.substring(r.endsAt+1);i=d+r.text+l}return i}doComponents(t="[\\w]+"){let e=g(this,$);const i=this.collectTags(e,t),n=[];let s=[],o=0;const r=[];let d=i.length,l=0,h=!1,u=0;const x=d;let y=!1;r[o]=-1;const{singleTags:I}=this.splitTags(i);let w=i;for(I.length&&(I.forEach(E=>n.push(E.id)),e=this.replaceTags(e,I),w=this.collectTags(e,t));w.length>0&&!h&&!y;){if(l===d){if(l=0,w=Object.values(w),d=w.length,d===0){h=!0;continue}u++,y=u>x+1}const E=w[l];if(w.length===1&&E.name==="Eof"){h=!0;continue}if(this.isClosedTag(E)&&E.name!=="Eof"){const j=this.makeTag(E,r,o,!1);j.isSingle=n.includes(E.id),s[j.id]=j,delete w[l],l++;continue}if(this.isCloserTag(E)&&o--,l+1<d){const j=w[l+1];if(!this.isCloserTag(E)&&this.isCloserTag(j)){const q=this.makeTag(E,r,o,!0),S=this.makeTag(j,r,o,!1,!0);S.contents={},S.parentId=q.id,S.contents.startsAt=q.endsAt+1,S.contents.endsAt=S.startsAt;const rt=e.substring(S.contents.startsAt,S.contents.endsAt);S.contents.text=rt,q.closer=S,s[q.id]=q,delete w[l],delete w[l+1],l+=2;continue}!this.isCloserTag(E)&&!this.isCloserTag(j)&&(o++,r[o]=E.id)}l++}s=Object.values(s),L(this,$,e),L(this,K,s)}}K=new WeakMap,G=new WeakMap,$=new WeakMap,R=new WeakMap,X=new WeakMap,Y=new WeakMap,Z=new WeakMap,Q=new WeakMap,tt=new WeakMap,nt=new WeakSet,bt=function(){return Date.now()*Math.random()};const O="&lt;",v="&gt;",B="<",H=">",F="/",N=`
`;class dt{constructor(t,e,i,n,s){_(this,et,"");_(this,U,60);_(this,st,!1);_(this,J,()=>{});_(this,z,()=>{});L(this,J,t),L(this,et,e),L(this,U,i),L(this,z,s),L(this,st,n)}async writeLikeAHuman(t,e){const i=e!==void 0,n=g(this,J).querySelector(`pre#${e} code`),s=g(this,J).querySelector(i?`pre#${t} code`:`div#${t}`);let o=g(this,U),r=[],d="",l="",h="",u=null,x=[];const y=[];let I="",w="",E=-1;const j=[],q=[];let S=0,rt=this;function gt(c){return new Promise(a=>{setTimeout(a,c)})}function $t(c){return Math.floor(c*.75+Math.random()*c)}async function A(c,a=!1){let T=r.join("");a&&(T=T.trim()),o=$t(g(rt,U)),d+=c,s.innerHTML=d+T,i&&window.hljs!==void 0&&window.hljs.highlightElement(s),await gt(o)}async function St(){const c=r.join("");d=d.substring(0,d.length-1),s.innerHTML=d+c,await gt(o)}function V(c){r.unshift(c)}function it(){delete r[0],r=Object.values(r)}function Lt(c){const a=[],T=/^([^\S][ \s]+)*/gm;let D;for(;(D=T.exec(c))!==null;)D.index===T.lastIndex&&T.lastIndex++,a.push(D[0]??"");return a}function Ot(c){const a=/^([^\S][ \s]+)*/gm;return c.replace(a,"")}function Mt(c){const a=c.split(`
`);return"<br />".repeat(a.length)}async function It(c){let a="";return await fetch(c).then(T=>T.text()).then(T=>{a=T}),a}function vt(c){return c.replaceAll(O,B).replaceAll(v,H)}function jt(){let c=null;return x.length&&(c=x.shift(),c.hasCloser&&y.push(c)),c}function Dt(){return y.length?y[y.length-1]:null}function Bt(){if(!j.length)return null;const c=j.pop(),a=q.pop();V(a?N+l+c:c)}function pt(c){let a=null;if(!y.length||(a=Dt(),c===a.depth))return a;let T=!1;for(let D=y.length-1;D>-1;D--)if(a=y[D],c===a.depth){T=!0;break}return T?a:null}const Nt=g(this,et);i&&window.hljs!==void 0&&window.hljs.highlightElement(n),I=await It(Nt);const mt=Lt(I);I=Ot(I);const b=new Tt(I,i);b.doComponents(),x=[...b.list],w=b.workingText.replace(`${N+O}Eof ${F}${v}`,""),i&&(n.innerHTML=Mt(I+`
`));const qt=mt[S]??"";await A(qt),S++;for(let c=0;c<w.length;c++){let a=w[c];if(i&&a===B){a=O,await A(a);continue}if(g(this,st)&&b.mistakes.length&&b.phraseStarts.length&&b.phraseStarts[0]===c){const k=b.phraseLengths[0];for(let p=0;p<k;p++){const P=c+p,at=b.mistakeCursors[0];if(a=w[P],at===P?await A(b.mistakes[0]):await A(a),b.wordEnds.includes(P)&&b.mistakeCursors.length){const lt=b.mistakeCursors[0];if(lt<=P){const ct=P-lt+1;for(let xt=0;xt<ct;xt++)await St(),p--;b.mistakes.shift(),b.mistakeCursors.shift()}}}b.phraseStarts.shift(),b.phraseLengths.shift(),c+=k-1;continue}const T=w.substring(c,c+4),D=w.substring(c,c+5);if(a==="&"&&D==="&oq;/"){const k=w.substring(c+5,c+6),{word:p}=b.translateBracket(a,k);it(),await A(p),c+=9;continue}if(a==="&"&&T==="&oq;"){const k=w.substring(c+4,c+5),{word:p}=b.translateBracket(a,k);V(p),await A(p),c+=8;continue}if(a==="&"&&T==="&pp;"){c+=3,await A(O);continue}if(a==="&"&&T==="&pg;"){c+=3,await A(v);continue}if(i){if(a==="/"&&D===F+v&&u!==null&&!u.hasCloser&&u.endsAt===c+4){a=F+v,it(),await A(a),c+=4;continue}if(a==="&"&&T===v&&u!==null&&u.endsAt===c+3){it(),await A(v),u.hasCloser&&Bt(),c+=3;continue}}if(a==="&"&&D===O+F){u=pt(E),u===null&&E-1>-1&&(u=pt(E-1)),a=u.closer.text,i||(a=B+F+u.closer.name+H);const{word:k}=b.translateBracket(a,u.name,!0);if(a=k,a!==""){it(),c=u.closer.endsAt,await A(a),E--,u=null;continue}}if(a==="&"&&T!==O){const k=w.substring(c).indexOf(";");if(k>8){await A(a);continue}const p=w.substring(c,c+k+1);await A(p),c+=p.length-1;continue}if(a==="&"&&T===O){if((u===null||u!==null&&u.dirty)&&(u=jt()),u.startsAt!==c){i?(a=O,c+=3):(a=u.text.replace(O,B),a=a.replace(v,H)),await A(a),u.dirty=!1;continue}u.dirty=!0;let k=!1,p="";a=u.text,i||(a=u.text.replace(O,B),a=a.replace(v,H));const{word:P,translated:at}=b.translateBracket(a,u.name);if(a=P,u.hasCloser){E++,p=u.closer.text,i||(p=B+F+u.closer.name+H);const{word:lt,translated:ct}=b.translateBracket(p,u.name,!0);p=lt,k=u.closer.contents.text.indexOf(N)>-1,ct?(c=u.endsAt,V(k?N+l+p:p)):(j.push(p),q.push(k))}at||(k=u.text.indexOf(N)>-1,i?(a=O,c+=3,p=v):(a=u.text.replace(O,B),a=a.replace(v,H),c+=u.text.length-1,p=B+F+u.closer.name+H),V(k?N+l+p:p)),await A(a);continue}if(a===N){l=mt[S]??"",h=N+l;const k=r.length?r[0].trim():"",p=w.substring(c+1,c+k.length+1);S++,await A(h,k===p);continue}await A(a)}d=vt(d),this.finishedEvent(d)}finishedEvent(t){typeof g(this,z)=="function"&&g(this,z).call(this,t)}}et=new WeakMap,U=new WeakMap,st=new WeakMap,J=new WeakMap,z=new WeakMap;const Wt="",kt=[f.createElementVNode("div",{class:"to-be-copied"},[f.createElementVNode("pre",{id:"to-copy"},[f.createElementVNode("code")])],-1),f.createElementVNode("div",{class:"to-be-written"},[f.createElementVNode("pre",{id:"to-write"},[f.createElementVNode("code")])],-1)],yt=f.defineComponent({name:"CodeWriter"}),ht=Object.assign(yt,{props:{source:{default:""},speed:{default:"60"},dependsOnSelector:{default:""},makeTypos:{default:!1},styles:{default:""},classes:{default:""},finished:{default:!1},restart:{default:!1},useHighlightJs:{default:!1},theme:{default:"base16/monokai"},language:{default:"html"}},setup(M){const t=M,e=f.ref(null);f.onMounted(async()=>{const s=e.value.ownerDocument;if(t.useHighlightJs){const o=t.theme??"base16/monokai",r=t.language??"html",d=s.createElement("script");d.src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js",s.head.appendChild(d);const l=[];l.push("https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/default.min.css"),l.push(`https://highlightjs.org/static/demo/styles/${o}.css`),l.forEach(u=>{const x=s.createElement("style");x.innerHTML=`@import "${u}"`,s.head.appendChild(x)});const h=s.querySelectorAll("code");for(const u of h)u.setAttribute("class",`language-${r}`)}if(t.styles!==""&&t.classes!==""&&(t.styles.split(",").forEach(d=>{const l=s.createElement("style");l.innerHTML=`@import "${d}"`,s.head.appendChild(l)}),s.getElementById("to-write").setAttribute("class",t.classes)),t.dependsOnSelector!==""){const o=s.querySelector(t.dependsOnSelector);if(o!==null){const r={attributes:!0};new MutationObserver(async(l,h)=>{for(const u of l)u.type==="attributes"&&u.attributeName==="finished"&&o.getAttribute("finished")==="true"&&(h.disconnect(),await n())}).observe(o,r)}}else await n()});const i=function(s){const o=new CustomEvent("finishedWriting",{bubbles:!0,cancellable:!0,detail:{content:s}});e.value.dispatchEvent(o),e.value.setAttribute("finished","true")},n=async()=>{const s=e.value.ownerDocument;await new dt(s,t.source,t.speed,t.makeTypos,i).writeLikeAHuman("to-write","to-copy")};return(s,o)=>(f.openBlock(),f.createElementBlock("div",{ref_key:"root",ref:e,class:"code-snippet"},kt,512))}}),Et=[f.createElementVNode("div",{class:"to-be-written"},[f.createElementVNode("div",{id:"to-write"})],-1)],At=f.defineComponent({name:"TextWriter"}),ft=Object.assign(At,{props:{source:{default:""},speed:{default:"60"},dependsOnSelector:{default:""},makeTypos:{default:!1},styles:{default:""},classes:{default:""},finished:{default:!1},restart:{default:!1}},setup(M){const t=M,e=f.ref(null);f.onMounted(async()=>{const s=e.value.ownerDocument;if(t.styles!==""&&t.classes!==""&&(t.styles.split(",").forEach(d=>{const l=s.createElement("style");l.innerHTML=`@import "${d}"`,s.head.appendChild(l)}),s.getElementById("to-write").setAttribute("class",t.classes)),t.dependsOnSelector!==""){const o=s.querySelector(t.dependsOnSelector);if(o!==null){const r={attributes:!0};new MutationObserver(async(l,h)=>{for(const u of l)u.type==="attributes"&&u.attributeName==="finished"&&o.getAttribute("finished")==="true"&&(h.disconnect(),await n())}).observe(o,r)}}else await n()});const i=function(s){const o=new CustomEvent("finishedWriting",{bubbles:!0,cancellable:!0,detail:{content:s}});e.value.dispatchEvent(o),e.value.setAttribute("finished","true")},n=async()=>{const s=e.value.ownerDocument;await new dt(s,t.source,t.speed,t.makeTypos,i).writeLikeAHuman("to-write")};return(s,o)=>(f.openBlock(),f.createElementBlock("div",{ref_key:"root",ref:e,class:"text-snippet"},Et,512))}}),Ct=M=>({textSpeed:M.speed,textTypos:M.makeTypos}),_t={install(M,t){M.config.globalProperties.$writerOptions=Ct(t),M.component("TextWriter",ft),M.component("CodeWriter",ht)}};m.CodeWriter=ht,m.TextWriter=ft,m.VueWriterPlugin=_t,Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});
